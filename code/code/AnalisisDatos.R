#Instalacion de librerias
install.packages("dplyr")
install.packages("ggplot2")
install.packages("tidyverse")

#Uso de librerias
library(dplyr)
library(ggplot2)
library(tidyverse)

#Configuracion de Working Directory
setwd('../../data')
getwd()

#Lectura de archivo
analyzedData <- read.csv('hotel_bookings_modified.csv', header = TRUE, stringsAsFactors = FALSE)

#Conversion de columna de character to date

#Columna: reservation_status_date
#Al no encontrar ningun dato faltante en la columna reservation_status_date se puede continuar con el cambio  
analyzedData$reservation_status_date <- as.Date(analyzedData$reservation_status_date, "%Y-%m-%d")


#Informacion de datos
head(analyzedData)
summary(analyzedData)
str(analyzedData)

#Pregunta 1 ¿Cuántas reservas se realizan por tipo de hotel? o ¿Qué tipo de hotel prefiere la gente?

analyzedData %>%
  count(hotel)

ggplot(data = analyzedData, mapping = aes(x = hotel), stat = "identity") +
  geom_bar()

#Pregunta 2 ¿Está aumentando la demanda con el tiempo?

wait_time <- analyzedData %>%
  group_by(format(reservation_status_date, "%Y"), hotel) %>%
    summarize(
      time = mean(lead_time, na.rm = TRUE),
    )

view(wait_time)

colnames(wait_time)
names(wait_time)[1] <- "year"

ggplot(data = wait_time, aes(year,time, group = hotel)) +
  geom_line(aes(color = hotel)) + 
  geom_point(aes(group = hotel))
  

#Pregunta 3 ¿Cuándo se producen las temporadas de reservas: alta, media y baja?

#Pregunta 4 ¿Cuándo es menor la demanda de reservas?

#Pregunta 5 ¿Cuántas reservas incluyen niños y/o bebes?

onlyBabiesorChildrens <- filter(analyzedData, babies > 0 | children > 0)
onlyBabiesandChildrens <- filter(analyzedData, babies > 0 & children > 0)

#Pregunta 6 ¿Es importante contar con espacios de estacionamiento?

#Pregunta 7 ¿En qué meses del año se producen más cancelaciones de reservas?

cancelsMonth <- analyzedData %>%
  group_by(format(reservation_status_date, "%m"), hotel) %>%
  summarize(
    amountOfCanceled = sum(is_canceled, na.rm = TRUE),
  )

colnames(cancelsMonth)
names(cancelsMonth)[1] <- "month"

view(cancelsMonth)

ggplot(data = cancelsMonth, aes(month, amountOfCanceled, hotel)) +
  geom_point(aes(color = hotel)) + 
  geom_line(aes(group = hotel))
  
